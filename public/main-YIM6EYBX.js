import{d as _e}from"./chunk-QZWMSONR.js";import{a as re,b as ne,c as xe}from"./chunk-52YDT6JR.js";import{A as pe,B as me,C as ge,D as fe,F as he,G as ve,J as ye,S as Se,T as be,U as Ae,a as K,b as X,d as Y,f as Q,g as x,h as ee,i as te,j as ie,t as oe,u as ae,v as se,w as le,x as ce,y as de,z as ue}from"./chunk-4TCFWNX2.js";import{d as H,j as J}from"./chunk-FF7OLIXW.js";import{$a as l,Ca as T,Cb as o,Db as a,Eb as u,Ib as z,La as F,Lb as G,Mb as I,Pb as W,Vb as s,Wb as A,Xb as Z,Ya as N,Zb as q,aa as R,ab as C,bb as j,da as v,db as $,e as p,fb as B,ga as M,hb as U,ia as y,ib as b,ja as m,ka as g,oa as D,ra as S,rb as V,tb as d,wa as L,xa as O}from"./chunk-52PAEBTB.js";var _=(()=>{class i{constructor(e,r,n){this.authService=e,this.firestoreService=r,this.router=n,this.logged=!1,console.log("UserService init"),this.getState()}getState(){return new Promise((e,r)=>{if(this.logged){e(this.user);return}this.authService.authState.subscribe(n=>{n?(this.user=n,this.logged=!0,this.getUserProfile(n.uid)):(this.user=null,this.logged=!1),e(this.user)})})}getUserProfile(e){return p(this,null,function*(){return new Promise(r=>p(this,null,function*(){if(this.userProfile){r(this.userProfile);return}let n=yield this.firestoreService.getDocument(`usuarios/${e}`);if(n.exists()&&(this.userProfile=n.data(),r(this.userProfile),this.userProfile.email!=this.user.email)){console.log("sincronizar email");let c={email:this.user.email};this.firestoreService.updateDocument(`usuarios/${e}`,c)}}))})}getLogged(){return this.logged}getRol(){return this.userProfile.rol}logout(){return this.logged=!1,this.user=null,this.userProfile=null,this.router.navigate(["/home"]),this.authService.logout()}static{this.\u0275fac=function(r){return new(r||i)(y(xe),y(Ae),y(x))}}static{this.\u0275prov=v({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var w=(i,t)=>{let e=m(_),r=m(re);return new Promise(n=>{e.getRol()=="admin"?n(!0):(r.error("Debes ser administrador para acceder a esta seccion.","Permisos insuficientes"),n(!1))})};var Ie=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-324MSNQD.js").then(i=>i.HomeComponent)},{path:"login",loadComponent:()=>import("./chunk-253UINLZ.js").then(i=>i.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-IIZAHW2Z.js").then(i=>i.RegisterComponent)},{path:"usuarios",loadComponent:()=>import("./chunk-3AFIRCEJ.js").then(i=>i.UsuariosComponent),canActivate:[w]},{path:"registro-admin/:rol",loadComponent:()=>import("./chunk-BRI5QFO5.js").then(i=>i.RegistroAdminComponent),canActivate:[w]}];var f=class{constructor(t){return t}},we="storage",k=class{constructor(){return le(we)}};var E=new M("angularfire2.storage-instances");function Te(i,t){let e=se(we,i,t);return e&&new f(e)}function Fe(i){return(t,e)=>{let r=t.runOutsideAngular(()=>i(e));return new f(r)}}var Ne={provide:k,deps:[[new g,E]]},je={provide:f,useFactory:Te,deps:[[new g,E],pe]};function ke(i,...t){return oe("angularfire",ae.full,"gcs"),S([je,Ne,{provide:E,useFactory:Fe(i),multi:!0,deps:[b,T,de,me,[new g,he],[new g,ce],...t]}])}var Ee=ue(_e,!0);var $e="@",Be=(()=>{class i{constructor(e,r,n,c,h){this.doc=e,this.delegate=r,this.zone=n,this.animationType=c,this.moduleImpl=h,this._rendererFactoryPromise=null,this.scheduler=m($,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-K5KPQZXL.js")).catch(r=>{throw new R(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:n})=>{this._engine=r(this.animationType,this.doc,this.scheduler);let c=new n(this.delegate,this._engine,this.zone);return this.delegate=c,c})}createRenderer(e,r){let n=this.delegate.createRenderer(e,r);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let c=new P(n);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(h=>{let De=h.createRenderer(e,r);c.use(De)}).catch(h=>{c.use(n)}),c}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(r){j()}}static{this.\u0275prov=v({token:i,factory:i.\u0275fac})}}return i})(),P=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let e of this.replay)e(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,e){this.delegate.appendChild(t,e)}insertBefore(t,e,r,n){this.delegate.insertBefore(t,e,r,n)}removeChild(t,e,r){this.delegate.removeChild(t,e,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,n){this.delegate.setAttribute(t,e,r,n)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,n){this.delegate.setStyle(t,e,r,n)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){this.shouldReplay(e)&&this.replay.push(n=>n.setProperty(t,e,r)),this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.shouldReplay(e)&&this.replay.push(n=>n.listen(t,e,r)),this.delegate.listen(t,e,r)}shouldReplay(t){return this.replay!==null&&t.startsWith($e)}};function Pe(i="animations"){return U("NgAsyncAnimations"),S([{provide:B,useFactory:(t,e,r)=>new Be(t,e,r,i),deps:[H,K,b]},{provide:F,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Re={providers:[ie(Ie),ge(()=>fe({projectId:"clinica-online-monserrat",appId:"1:852468060524:web:1dc5a2bf84de0a8c136349",storageBucket:"clinica-online-monserrat.appspot.com",apiKey:"AIzaSyCL8ZnSu6G_ivMtA1q_u-g3JW8FlB3LzlU",authDomain:"clinica-online-monserrat.firebaseapp.com",messagingSenderId:"852468060524"})),ve(()=>ye()),Se(()=>be()),ke(()=>Ee()),Pe(),ne()]};function Ue(i,t){i&1&&(o(0,"li",7)(1,"button",11),s(2,"Iniciar sesion"),a()())}function Ve(i,t){i&1&&(o(0,"li",7)(1,"button",12),s(2,"Registrarse"),a()())}function ze(i,t){i&1&&(o(0,"li",7)(1,"button",13),s(2,"Ayuda"),a()())}function Ge(i,t){i&1&&(o(0,"li",7)(1,"button",14),s(2,"Usuarios"),a()())}function We(i,t){i&1&&(o(0,"li",7)(1,"button",15),s(2,"Turnos"),a()())}function Ze(i,t){i&1&&(o(0,"li",7)(1,"button",16),s(2,"Mis turnos"),a()())}function qe(i,t){i&1&&(o(0,"li",7)(1,"button",17),s(2,"Solicitar turno"),a()())}function He(i,t){if(i&1){let e=z();o(0,"li",18)(1,"button",19)(2,"b"),s(3),a()(),o(4,"div",20)(5,"div",21),u(6,"img",22),a(),u(7,"div",23),o(8,"b",24),s(9,"Datos"),a(),o(10,"span",25),s(11),a(),o(12,"span",25),s(13),a(),o(14,"span",26),s(15),a(),u(16,"div",23),o(17,"a",27)(18,"b",28),s(19,"Mi perfil"),a()(),u(20,"div",23),o(21,"a",29),G("click",function(){L(e);let n=I();return O(n.logout())}),o(22,"b",28),s(23,"Cerrar sesion"),a()()()()}if(i&2){let e=I();l(3),A(e.userData.nombre+" "+e.userData.apellido),l(3),W("src",e.userData.imagenUno,N),l(5),A(e.userData.nombre+" "+e.userData.apellido),l(2),A(e.userData.email),l(2),Z("Perfil de ",e.rol,"")}}var Me=(()=>{class i{constructor(e,r){this.userService=e,this.router=r,this.firstTime=!0,this.isLogged=!1,this.rol="",this.router.events.subscribe(n=>{n instanceof Y&&this.checkState()})}checkState(){return p(this,null,function*(){if(this.firstTime){let e=yield this.userService.getState();e&&(this.isLogged=!0,this.firstTime=!1,this.userService.getUserProfile(e.uid).then(r=>{this.userData=r,this.rol=r.rol}),this.router.navigate(["/home"]))}})}logout(){this.userService.logout().then(()=>{this.isLogged=!1}).catch(e=>console.log(e))}static{this.\u0275fac=function(r){return new(r||i)(C(_),C(x))}}static{this.\u0275cmp=D({type:i,selectors:[["app-root"]],standalone:!0,features:[q],decls:19,vars:8,consts:[[1,"custom-nav","navbar","navbar-expand-lg","navbar-light","shadow"],["routerLink","home",1,"navbar-brand","d-flex","align-items-center"],["src","assets/icon_mon.png","alt","Icono",1,"d-inline-block","align-top","ml-2","mt-1","icono"],["type","button","data-toggle","collapse","data-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse","justify-content-end"],[1,"navbar-nav","nav-opt"],[1,"nav-item","mx-3"],["routerLink","home","routerLinkActive","ruta-activa",1,"nav-link"],["class","nav-item mx-3",4,"ngIf"],["class","nav-item dropdown mx-3 d-flex",4,"ngIf"],["routerLink","login","routerLinkActive","ruta-activa",1,"nav-link"],["routerLink","register","routerLinkActive","ruta-activa",1,"nav-link"],["routerLink","ayuda","routerLinkActive","ruta-activa",1,"nav-link"],["routerLink","usuarios","routerLinkActive","ruta-activa",1,"nav-link"],["routerLink","turnos","routerLinkActive","ruta-activa",1,"nav-link"],["routerLink","mis-turnos","routerLinkActive","ruta-activa",1,"nav-link"],["routerLink","solicitar-turno","routerLinkActive","ruta-activa",1,"nav-link"],[1,"nav-item","dropdown","mx-3","d-flex"],["id","navbarDropdown","role","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle"],["aria-labelledby","navbarDropdown",1,"dropdown-menu","dropdown-menu-end","mb-3","rounded-bottom"],[1,"col","img-container","text-center"],["width","110","alt","Perfil",1,"img-user",3,"src"],[1,"dropdown-divider"],[1,"dropdown-item-text","logout-text","mt-1"],[1,"dropdown-item-text","logout-text"],[1,"dropdown-item-text","logout-text","mb-4"],["routerLink","mi-perfil",1,"dropdown-item"],[1,"logout-text"],[1,"dropdown-item",3,"click"]],template:function(r,n){r&1&&(o(0,"nav",0)(1,"a",1),u(2,"img",2),a(),o(3,"button",3),u(4,"span",4),a(),o(5,"div",5)(6,"ul",6)(7,"li",7)(8,"button",8),s(9,"Inicio"),a()(),V(10,Ue,3,0,"li",9)(11,Ve,3,0,"li",9)(12,ze,3,0,"li",9)(13,Ge,3,0,"li",9)(14,We,3,0,"li",9)(15,Ze,3,0,"li",9)(16,qe,3,0,"li",9)(17,He,24,5,"li",10),a()()(),u(18,"router-outlet")),r&2&&(l(10),d("ngIf",n.isLogged==!1),l(),d("ngIf",n.isLogged==!1),l(),d("ngIf",n.isLogged==!1),l(),d("ngIf",n.rol==="admin"),l(),d("ngIf",n.rol==="admin"),l(),d("ngIf",n.rol==="paciente"||n.rol==="especialista"),l(),d("ngIf",n.rol==="admin"||n.rol==="paciente"),l(),d("ngIf",n.isLogged))},dependencies:[Q,ee,te,J],styles:[".nav-link[_ngcontent-%COMP%]{color:#000}.ruta-activa[_ngcontent-%COMP%]{font-weight:900;color:#183058}.custom-nav[_ngcontent-%COMP%]{height:120px;background-color:#fff;transition:all;padding:0 10px;z-index:2;position:fixed;width:100%;display:flex;flex-direction:column}.nav-opt[_ngcontent-%COMP%]{background-color:#0000;cursor:pointer;z-index:2;font-size:17px;font-weight:400}.nav-opt[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000}.icono[_ngcontent-%COMP%]{width:90px}.tit-icono[_ngcontent-%COMP%]{color:#cd1c2a;font-weight:600}.tit-icono-2[_ngcontent-%COMP%]{color:#154688}.logout-text[_ngcontent-%COMP%]{color:#000;width:100%;display:flex;justify-content:center}.img-user[_ngcontent-%COMP%]{border:solid 4px #232323;border-radius:50%;margin:25px 0}"]})}}return i})();X(Me,Re).catch(i=>console.error(i));
