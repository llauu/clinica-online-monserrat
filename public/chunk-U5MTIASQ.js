import{a as oe}from"./chunk-CVIZ75M7.js";import{a as re}from"./chunk-6A53CKUR.js";import{a as J}from"./chunk-SZYKANWC.js";import{c as K,f as Q,k as X,m as Z,r as ee,s as te,t as ie,v as ne}from"./chunk-PCZAAENJ.js";import"./chunk-KB63F72J.js";import"./chunk-CWSCUUYC.js";import{D as R,N as q}from"./chunk-GMVTRFNN.js";import{c as U,d as Y,g as T,j as G}from"./chunk-CARY4E7O.js";import{g as j,j as B,k as L}from"./chunk-V6SC6RTQ.js";import{$a as P,Cb as a,Db as r,Eb as w,Ib as S,Nb as M,Ob as m,Rb as F,Xa as O,Xb as s,Yb as f,Zb as I,_a as l,aa as H,ac as b,bc as y,cc as E,ec as N,ic as W,jc as A,la as k,na as D,qb as g,sb as d,tb as z,ua as $,va as x,wa as C,xb as V}from"./chunk-NVPCUW4N.js";import"./chunk-FK6H3RFT.js";import"./chunk-5G567QLT.js";var se=(()=>{class o{constructor(){this.appHorarios=""}ngOnInit(){this.updateBackgroundColor()}ngOnChanges(){this.updateBackgroundColor()}updateBackgroundColor(){parseInt(this.appHorarios)>0?this.backgroundColor="#7bc4f8":this.backgroundColor="#f87c87"}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275dir=D({type:o,selectors:[["","appHorarios",""]],hostVars:2,hostBindings:function(n,i){n&2&&z("background-color",i.backgroundColor)},inputs:{appHorarios:"appHorarios"},standalone:!0,features:[$]})}}return o})();var le=(()=>{class o{constructor(){}generarHistoriaClinicaPDF(e,n,i){let t=new re,u=new Date().toLocaleDateString(),h=t.internal.pageSize.getWidth();t.addImage(i,"PNG",h/2-25,10,50,30),t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Historia Cl\xEDnica",h/2,55,{align:"center"}),t.setFontSize(12),t.text("Cl\xEDnica Online Monserrat & Asociados",h/2,63,{align:"center"}),t.setFontSize(10),t.text(`Fecha de emisi\xF3n: ${u}`,h/2,70,{align:"center"}),t.setFillColor(230,230,250),t.roundedRect(10,80,h-20,45,3,3,"F"),t.setTextColor(40),t.setFontSize(13),t.text(`Paciente: ${e.nombre} ${e.apellido}`,15,90),t.text(`DNI: ${e.dni}`,15,98),t.text(`Obra social: ${e.obraSocial}`,15,106),t.text(`Edad: ${e.edad}`,15,114),t.setFontSize(15),t.setTextColor(60,100,180),t.text("Turnos del Paciente",10,135);let c=145;n.forEach((ce,Oe)=>{let{fecha:de,hora:pe,especialista:me,especialidad:ue,comentario:fe,historiaClinica:_}=ce;c>270&&(t.addPage(),c=20),t.setFillColor(245,245,245),t.roundedRect(10,c,h-20,10,2,2,"F"),t.setTextColor(50),t.setFontSize(13),t.text(`Turno del d\xEDa ${this.formatFecha(de)}`,12,c+7),c+=12,t.setFontSize(11),t.setTextColor(80),t.text(`Horario: ${pe} hs`,15,c),t.text(`Especialista: ${me}`,80,c),t.text(`Especialidad: ${ue}`,145,c),c+=8,t.setFontSize(10),t.setTextColor(100),t.text(`Comentario: ${fe||"Sin comentarios"}`,15,c),_&&(c+=10,c>270&&(t.addPage(),c=20),t.setFontSize(11),t.setTextColor(60,100,180),t.text("Detalles de Historia Cl\xEDnica:",15,c),c+=8,t.setTextColor(80),t.text(`Altura: ${_.altura} cm`,15,c),t.text(`Peso: ${_.peso} kg`,80,c),t.text(`Temperatura: ${_.temperatura} \xB0C`,145,c),c+=8,t.text(`Presi\xF3n: ${_.presion}`,15,c),_.datosDinamicos&&_.datosDinamicos.length>0&&_.datosDinamicos.slice(0,3).forEach((v,he)=>{switch(he){case 0:t.text(`${v.clave}: ${v.valor}`,80,c);break;case 1:t.text(`${v.clave}: ${v.valor}`,145,c);break;case 2:c+=8,t.text(`${v.clave}: ${v.valor}`,15,c);break}})),c+=12}),t.save(`Historia_Clinica_${e.nombre}_${e.apellido}.pdf`)}formatFecha(e){if(e instanceof R){let n=e.toDate();return j(n,"d MMM. y","en-US")}return""}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=H({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function _e(o,p){if(o&1&&w(0,"img",15),o&2){let e=m();F("src",e.user.imagenDos,O)}}function xe(o,p){if(o&1&&(a(0,"div",12)(1,"span"),s(2,"Obra social"),r(),a(3,"span"),s(4),r()()),o&2){let e=m();l(4),f(e.user.obraSocial)}}function Ce(o,p){if(o&1&&(a(0,"option",18),s(1),r()),o&2){let e=p.$implicit;d("value",e),l(),f(e)}}function ve(o,p){if(o&1){let e=S();a(0,"div",12)(1,"span"),s(2,"Habilitado"),r(),a(3,"span"),s(4),r()(),a(5,"div",12)(6,"span"),s(7,"Especialidad"),r(),a(8,"select",16),E("ngModelChange",function(i){x(e);let t=m();return y(t.selectedSpecialty,i)||(t.selectedSpecialty=i),C(i)}),M("change",function(){x(e);let i=m();return C(i.onSpecialtyChange())}),g(9,Ce,2,2,"option",17),r()()}if(o&2){let e=m();l(4),f(e.user.habilitado?"Si":"No"),l(4),b("ngModel",e.selectedSpecialty),l(),d("ngForOf",e.especialidadesEspecialista)}}function Se(o,p){if(o&1&&(a(0,"option",18),s(1),r()),o&2){let e=p.$implicit;d("value",e.id),l(),I(" ",e.nombre," ")}}function be(o,p){if(o&1){let e=S();a(0,"div",19)(1,"button",20),M("click",function(){x(e);let i=m();return C(i.descargarHistoriaClinica())}),s(2,"Descargar historia clinica"),r(),a(3,"div",21)(4,"select",22),E("ngModelChange",function(i){x(e);let t=m();return y(t.especialistaSeleccionado,i)||(t.especialistaSeleccionado=i),C(i)}),a(5,"option",23),s(6,"Todos"),r(),g(7,Se,2,2,"option",17),r(),a(8,"label",24),s(9,"Seleccione un especialista"),r()()()}if(o&2){let e=m();l(4),b("ngModel",e.especialistaSeleccionado),l(3),d("ngForOf",e.especialistasPaciente)}}function ye(o,p){if(o&1&&(a(0,"th",33),s(1),r()),o&2){let e=p.$implicit;l(),f(e)}}function Ee(o,p){if(o&1){let e=S();a(0,"td",34)(1,"input",35),E("ngModelChange",function(i){let t=x(e).$implicit,u=m(2);return y(u.schedule[t].start,i)||(u.schedule[t].start=i),C(i)}),r(),s(2,"hs "),r()}if(o&2){let e=p.$implicit,n=m(2);d("appHorarios",n.schedule[e].start),l(),d("appHorarios",n.schedule[e].start),b("ngModel",n.schedule[e].start)}}function Pe(o,p){if(o&1){let e=S();a(0,"td",34)(1,"input",35),E("ngModelChange",function(i){let t=x(e).$implicit,u=m(2);return y(u.schedule[t].end,i)||(u.schedule[t].end=i),C(i)}),r(),s(2,"hs "),r()}if(o&2){let e=p.$implicit,n=m(2);d("appHorarios",n.schedule[e].end),l(),d("appHorarios",n.schedule[e].end),b("ngModel",n.schedule[e].end)}}function we(o,p){o&1&&(a(0,"p",36),s(1,"\xA1Horarios actualizados con exito!"),r())}function Me(o,p){if(o&1){let e=S();a(0,"div",25)(1,"span",26),s(2),r(),a(3,"table")(4,"thead")(5,"tr"),w(6,"th",27),g(7,ye,2,1,"th",28),r()(),a(8,"tbody")(9,"tr")(10,"td",27),s(11,"Entrada"),r(),g(12,Ee,3,3,"td",29),r(),a(13,"tr")(14,"td",27),s(15,"Salida"),r(),g(16,Pe,3,3,"td",29),r()()(),a(17,"p",30),s(18),r(),g(19,we,2,0,"p",31),a(20,"button",32),M("click",function(){x(e);let i=m();return C(i.updateSchedule())}),s(21,"Guardar"),r()()}if(o&2){let e=m();l(2),I("Horarios para ",e.selectedSpecialty,""),l(5),d("ngForOf",e.weekDays),l(5),d("ngForOf",e.weekDays),l(4),d("ngForOf",e.weekDays),l(2),f(e.messageError),l(),d("ngIf",e.horariosActualizados)}}var je=(()=>{class o{constructor(e,n,i){this.userService=e,this.firestoreService=n,this.pdfService=i,this.especialidadesEspecialista=[],this.selectedSpecialty=null,this.weekDays=["Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],this.schedule={},this.messageError="",this.horariosActualizados=!1,this.turnos=[],this.logoUrl="assets/icon_mon.png",this.especialistaSeleccionado="Todos",this.especialistasPaciente=[]}ngOnInit(){this.userService.getUserProfile().then(e=>{this.user=e,this.user.rol==="especialista"?this.user&&typeof this.user.especialidad=="object"?this.especialidadesEspecialista=Object.keys(this.user.especialidad):console.error("Error al obtener las especialidades del usuario"):this.user.rol==="paciente"&&this.firestoreService.getTurnosFinalizadosPorPaciente(this.user.id).then(n=>{this.turnos=n,this.turnos.sort((i,t)=>i.fecha.seconds-t.fecha.seconds),this.cargarEspecialistasUnicos()})}),this.weekDays.forEach(e=>{this.schedule[e]={start:"",end:""}})}cargarEspecialistasUnicos(){let e=new Map;this.turnos.forEach(n=>{let i=n.idEspecialista,t=n.especialista;e.has(i)||e.set(i,t)}),this.especialistasPaciente=Array.from(e,([n,i])=>({id:n,nombre:i}))}descargarHistoriaClinica(){let e=this.especialistaSeleccionado==="Todos"?this.turnos:this.turnos.filter(n=>n.idEspecialista===this.especialistaSeleccionado);this.pdfService.generarHistoriaClinicaPDF(this.user,e,this.logoUrl)}onSpecialtyChange(){this.selectedSpecialty&&this.firestoreService.obtenerHorariosEspecialidad(this.user.id,this.selectedSpecialty).then(e=>{this.schedule=this.mapFirestoreScheduleToLocal(e)}).catch(e=>console.error("Error al obtener el horario:",e))}mapFirestoreScheduleToLocal(e){let n={};return this.weekDays.forEach(i=>{n[i]={start:"",end:""}}),e.forEach(i=>{n[i.dia]={start:i.hora_inicio,end:i.hora_fin}}),n}updateSchedule(){if(this.selectedSpecialty){let e=!0;this.horariosActualizados=!1,this.weekDays.forEach(n=>{let i=this.schedule[n].start?Number(this.schedule[n].start):null,t=this.schedule[n].end?Number(this.schedule[n].end):null,u=19,h=8;n=="Sabado"&&(u=14),i!==null&&i!==0&&(i<h||i>u)&&(this.messageError=`El horario de atencion para el dia ${n} es de ${h}hs a ${u}hs.`,e=!1),t!==null&&i!==0&&(t<h||t>u)&&(this.messageError=`El horario de atencion para el dia ${n} es de ${h}hs a ${u}hs.`,e=!1),i!==null&&i!==0&&t!==null&&i>=t&&(this.messageError=`La hora de entrada para el ${n} debe ser menor que la de salida.`,e=!1)}),e?(this.horariosActualizados=!0,this.messageError="",console.log("Todo valido"),this.firestoreService.actualizarHorariosEspecialidad(this.user.id,this.selectedSpecialty,this.schedule)):console.log("Horarios no validos")}}static{this.\u0275fac=function(n){return new(n||o)(P(J),P(q),P(le))}}static{this.\u0275cmp=k({type:o,selectors:[["app-perfil"]],standalone:!0,features:[N],decls:48,vars:14,consts:[[1,"container"],[1,"row","justify-content-center"],[1,"col-md-10","reg-container","card-top"],[1,"card","mt-5"],[1,"card-header"],[1,"text-center","mt-3","h1-custom"],[1,"card-body"],[1,"div-imgs"],["alt","Imagen uno",1,"img-perfil","mx-4",3,"src"],["class","img-perfil mx-4","alt","Imagen dos",3,"src",4,"ngIf"],[1,"form-container"],[1,"perfil","mt-5","pb-4"],[1,"perfil-dato"],["class","w-100 d-flex flex-column align-items-center mt-5",4,"ngIf"],["class","div-horarios mt-5",4,"ngIf"],["alt","Imagen dos",1,"img-perfil","mx-4",3,"src"],["aria-label","Selecciona una especialidad",1,"form-select","form-select-sm","custom-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"w-100","d-flex","flex-column","align-items-center","mt-5"],[1,"btn","btn-reg","col-4",3,"click"],[1,"form-floating","col-4","mt-3"],["id","especialista",1,"form-select",3,"ngModelChange","ngModel"],["selected","","value","Todos"],["for","especialista"],[1,"div-horarios","mt-5"],[1,"h-cambio-horario","mb-3"],[1,"th-horas"],["class","th-horas th-horas-dias",4,"ngFor","ngForOf"],["class","th-horas-datos",3,"appHorarios",4,"ngFor","ngForOf"],[1,"errorMsg","mt-3"],["class","msg-exito mt-3",4,"ngIf"],["type","submit",1,"btn","btn-reg","mt-5","col-4",3,"click"],[1,"th-horas","th-horas-dias"],[1,"th-horas-datos",3,"appHorarios"],["type","number",3,"ngModelChange","appHorarios","ngModel"],[1,"msg-exito","mt-3"]],template:function(n,i){if(n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),s(6,"Mi perfil"),r()(),a(7,"div",6)(8,"div",7),w(9,"img",8),g(10,_e,1,1,"img",9),r(),a(11,"div",10)(12,"div",11)(13,"div",12)(14,"span"),s(15,"Nombre"),r(),a(16,"span"),s(17),r()(),a(18,"div",12)(19,"span"),s(20,"Apellido"),r(),a(21,"span"),s(22),r()(),a(23,"div",12)(24,"span"),s(25,"Edad"),r(),a(26,"span"),s(27),r()(),a(28,"div",12)(29,"span"),s(30,"DNI"),r(),a(31,"span"),s(32),r()(),a(33,"div",12)(34,"span"),s(35,"Correo"),r(),a(36,"span"),s(37),r()(),a(38,"div",12)(39,"span"),s(40,"Perfil"),r(),a(41,"span"),s(42),W(43,"primerLetraMayus"),r()(),g(44,xe,5,1)(45,ve,10,3),r(),g(46,be,10,2,"div",13)(47,Me,22,6,"div",14),r()()()()()()),n&2){let t;d("@slideInOut",void 0),l(9),F("src",i.user.imagenUno,O),l(),d("ngIf",i.user.rol==="paciente"),l(7),f(i.user.nombre),l(5),f(i.user.apellido),l(5),f(i.user.edad),l(5),f(i.user.dni),l(5),f(i.user.email),l(5),f(A(43,12,i.user.rol)),l(2),V(44,(t=i.user.rol)==="paciente"?44:t==="especialista"?45:-1),l(2),d("ngIf",i.user.rol==="paciente"),l(),d("ngIf",i.selectedSpecialty)}},dependencies:[L,B,ne,te,ie,K,Z,ee,Q,X,se,oe],styles:[".card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{background-color:#e4e4e4;border:none}.card-top[_ngcontent-%COMP%]{margin:150px 0}.h1-custom[_ngcontent-%COMP%]{font-weight:900;font-size:30px;color:#183058}.div-imgs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.img-perfil[_ngcontent-%COMP%]{width:200px;border-radius:50%}.perfil[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:10px;max-width:750px;margin:auto}.perfil-dato[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px;margin:0 30px;border-bottom:1px solid #ccc}.perfil-dato[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:700}.custom-select[_ngcontent-%COMP%]{width:150px}.div-horarios[_ngcontent-%COMP%]{width:750px;margin:auto;display:flex;flex-direction:column;align-items:center;padding-bottom:40px}.h-cambio-horario[_ngcontent-%COMP%]{font-weight:700;font-size:20px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:10px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px;width:90px;text-align:center;border:1px solid #ddd}.th-horas[_ngcontent-%COMP%]{background-color:#fff;font-weight:700}.th-horas-dias[_ngcontent-%COMP%]{padding:8px 0}.th-horas-datos[_ngcontent-%COMP%], .th-horas-datos[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#fff}input[type=number][_ngcontent-%COMP%]{width:60%;border:none;border-bottom:1px solid #000000;background-color:#fff;text-align:center}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]:focus{outline:none;box-shadow:none;border-color:transparent}td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:30px!important}.btn-reg[_ngcontent-%COMP%]{background-color:#183058;color:#fff;font-size:22px;font-weight:600}.errorMsg[_ngcontent-%COMP%]{color:red;font-size:15px;margin:0;font-weight:500}.msg-exito[_ngcontent-%COMP%]{color:#1b4fa8;font-size:15px;font-weight:700;margin:0}"],data:{animation:[U("slideInOut",[G(":enter",[T({transform:"translateY(-90%)",opacity:0}),Y("500ms ease-in",T({transform:"translateY(0)",opacity:1}))])])]}})}}return o})();export{je as PerfilComponent};
