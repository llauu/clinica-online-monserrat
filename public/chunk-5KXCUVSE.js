import{a as N}from"./chunk-SSGEGXZ2.js";import"./chunk-Q3HY2LAP.js";import{c as A,f as B,k as W,m as j,r as L,s as $,t as U,v as q}from"./chunk-LDTVX5G4.js";import"./chunk-THQPPHQV.js";import{L as z}from"./chunk-VNZCHZJ2.js";import{j as V,k as D}from"./chunk-JV3CWM4K.js";import{$b as m,Ab as k,Fb as o,Gb as i,Hb as C,Lb as _,Qb as w,Rb as p,Ub as M,_a as S,_b as a,ac as F,bb as s,cb as E,cc as v,dc as b,ec as y,gc as T,pa as P,ra as O,tb as h,vb as c,wb as H,xa as I,ya as g,za as f}from"./chunk-7MNHCEPS.js";var G=(()=>{class r{constructor(){this.appHorarios=""}ngOnInit(){this.updateBackgroundColor()}ngOnChanges(){this.updateBackgroundColor()}updateBackgroundColor(){parseInt(this.appHorarios)>0?this.backgroundColor="#7bc4f8":this.backgroundColor="#f87c87"}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275dir=O({type:r,selectors:[["","appHorarios",""]],hostVars:2,hostBindings:function(n,t){n&2&&H("background-color",t.backgroundColor)},inputs:{appHorarios:"appHorarios"},standalone:!0,features:[I]})}}return r})();function K(r,d){if(r&1&&C(0,"img",14),r&2){let e=p();M("src",e.user.imagenDos,S)}}function Q(r,d){if(r&1&&(o(0,"div",12)(1,"span"),a(2,"Obra social"),i(),o(3,"span"),a(4),i()()),r&2){let e=p();s(4),m(e.user.obraSocial)}}function R(r,d){if(r&1&&(o(0,"option",17),a(1),i()),r&2){let e=d.$implicit;c("value",e),s(),m(e)}}function X(r,d){if(r&1){let e=_();o(0,"div",12)(1,"span"),a(2,"Habilitado"),i(),o(3,"span"),a(4),i()(),o(5,"div",12)(6,"span"),a(7,"Especialidad"),i(),o(8,"select",15),y("ngModelChange",function(t){g(e);let l=p();return b(l.selectedSpecialty,t)||(l.selectedSpecialty=t),f(t)}),w("change",function(){g(e);let t=p();return f(t.onSpecialtyChange())}),h(9,R,2,2,"option",16),i()()}if(r&2){let e=p();s(4),m(e.user.habilitado?"Si":"No"),s(4),v("ngModel",e.selectedSpecialty),s(),c("ngForOf",e.especialidadesEspecialista)}}function Y(r,d){if(r&1&&(o(0,"th",26),a(1),i()),r&2){let e=d.$implicit;s(),m(e)}}function Z(r,d){if(r&1){let e=_();o(0,"td",27)(1,"input",28),y("ngModelChange",function(t){let l=g(e).$implicit,u=p(2);return b(u.schedule[l].start,t)||(u.schedule[l].start=t),f(t)}),i(),a(2,"hs "),i()}if(r&2){let e=d.$implicit,n=p(2);c("appHorarios",n.schedule[e].start),s(),c("appHorarios",n.schedule[e].start),v("ngModel",n.schedule[e].start)}}function ee(r,d){if(r&1){let e=_();o(0,"td",27)(1,"input",28),y("ngModelChange",function(t){let l=g(e).$implicit,u=p(2);return b(u.schedule[l].end,t)||(u.schedule[l].end=t),f(t)}),i(),a(2,"hs "),i()}if(r&2){let e=d.$implicit,n=p(2);c("appHorarios",n.schedule[e].end),s(),c("appHorarios",n.schedule[e].end),v("ngModel",n.schedule[e].end)}}function te(r,d){r&1&&(o(0,"p",29),a(1,"\xA1Horarios actualizados con exito!"),i())}function ie(r,d){if(r&1){let e=_();o(0,"div",18)(1,"span",19),a(2),i(),o(3,"table")(4,"thead")(5,"tr"),C(6,"th",20),h(7,Y,2,1,"th",21),i()(),o(8,"tbody")(9,"tr")(10,"td",20),a(11,"Entrada"),i(),h(12,Z,3,3,"td",22),i(),o(13,"tr")(14,"td",20),a(15,"Salida"),i(),h(16,ee,3,3,"td",22),i()()(),o(17,"p",23),a(18),i(),h(19,te,2,0,"p",24),o(20,"button",25),w("click",function(){g(e);let t=p();return f(t.updateSchedule())}),a(21,"Guardar"),i()()}if(r&2){let e=p();s(2),F("Horarios para ",e.selectedSpecialty,""),s(5),c("ngForOf",e.weekDays),s(5),c("ngForOf",e.weekDays),s(4),c("ngForOf",e.weekDays),s(2),m(e.messageError),s(),c("ngIf",e.horariosActualizados)}}var de=(()=>{class r{constructor(e,n){this.userService=e,this.firestoreService=n,this.especialidadesEspecialista=[],this.selectedSpecialty=null,this.weekDays=["Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],this.schedule={},this.messageError="",this.horariosActualizados=!1}ngOnInit(){this.userService.getUserProfile().then(e=>{this.user=e,this.user&&typeof this.user.especialidad=="object"?this.especialidadesEspecialista=Object.keys(this.user.especialidad):console.error("Error al obtener las especialidades del usuario")}),this.weekDays.forEach(e=>{this.schedule[e]={start:"",end:""}})}onSpecialtyChange(){this.selectedSpecialty&&this.firestoreService.obtenerHorariosEspecialidad(this.user.id,this.selectedSpecialty).then(e=>{this.schedule=this.mapFirestoreScheduleToLocal(e)}).catch(e=>console.error("Error al obtener el horario:",e))}mapFirestoreScheduleToLocal(e){let n={};return this.weekDays.forEach(t=>{n[t]={start:"",end:""}}),e.forEach(t=>{n[t.dia]={start:t.hora_inicio,end:t.hora_fin}}),n}updateSchedule(){if(this.selectedSpecialty){let e=!0;this.horariosActualizados=!1,this.weekDays.forEach(n=>{let t=this.schedule[n].start?Number(this.schedule[n].start):null,l=this.schedule[n].end?Number(this.schedule[n].end):null,u=19,x=8;n=="Sabado"&&(u=14),t!==null&&t!==0&&(t<x||t>u)&&(this.messageError=`El horario de atencion para el dia ${n} es de ${x}hs a ${u}hs.`,e=!1),l!==null&&t!==0&&(l<x||l>u)&&(this.messageError=`El horario de atencion para el dia ${n} es de ${x}hs a ${u}hs.`,e=!1),t!==null&&t!==0&&l!==null&&t>=l&&(this.messageError=`La hora de entrada para el ${n} debe ser menor que la de salida.`,e=!1)}),e?(this.horariosActualizados=!0,this.messageError="",console.log("Todo valido"),this.firestoreService.actualizarHorariosEspecialidad(this.user.id,this.selectedSpecialty,this.schedule)):console.log("Horarios no validos")}}static{this.\u0275fac=function(n){return new(n||r)(E(N),E(z))}}static{this.\u0275cmp=P({type:r,selectors:[["app-perfil"]],standalone:!0,features:[T],decls:46,vars:10,consts:[[1,"container"],[1,"row","justify-content-center"],[1,"col-md-10","reg-container","card-top"],[1,"card","mt-5"],[1,"card-header"],[1,"text-center","mt-3","h1-custom"],[1,"card-body"],[1,"div-imgs"],["alt","Imagen uno",1,"img-perfil","mx-4",3,"src"],["class","img-perfil mx-4","alt","Imagen dos",3,"src",4,"ngIf"],[1,"form-container"],[1,"perfil","mt-5","pb-4"],[1,"perfil-dato"],["class","div-horarios mt-5",4,"ngIf"],["alt","Imagen dos",1,"img-perfil","mx-4",3,"src"],["aria-label","Selecciona una especialidad",1,"form-select","form-select-sm","custom-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"div-horarios","mt-5"],[1,"h-cambio-horario","mb-3"],[1,"th-horas"],["class","th-horas th-horas-dias",4,"ngFor","ngForOf"],["class","th-horas-datos",3,"appHorarios",4,"ngFor","ngForOf"],[1,"errorMsg","mt-3"],["class","msg-exito mt-3",4,"ngIf"],["type","submit",1,"btn","btn-reg","mt-5","col-4",3,"click"],[1,"th-horas","th-horas-dias"],[1,"th-horas-datos",3,"appHorarios"],["type","number",3,"ngModelChange","appHorarios","ngModel"],[1,"msg-exito","mt-3"]],template:function(n,t){if(n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),a(6,"Mi perfil"),i()(),o(7,"div",6)(8,"div",7),C(9,"img",8),h(10,K,1,1,"img",9),i(),o(11,"div",10)(12,"div",11)(13,"div",12)(14,"span"),a(15,"Nombre"),i(),o(16,"span"),a(17),i()(),o(18,"div",12)(19,"span"),a(20,"Apellido"),i(),o(21,"span"),a(22),i()(),o(23,"div",12)(24,"span"),a(25,"Edad"),i(),o(26,"span"),a(27),i()(),o(28,"div",12)(29,"span"),a(30,"DNI"),i(),o(31,"span"),a(32),i()(),o(33,"div",12)(34,"span"),a(35,"Correo"),i(),o(36,"span"),a(37),i()(),o(38,"div",12)(39,"span"),a(40,"Perfil"),i(),o(41,"span"),a(42),i()(),h(43,Q,5,1)(44,X,10,3),i(),h(45,ie,22,6,"div",13),i()()()()()()),n&2){let l;s(9),M("src",t.user.imagenUno,S),s(),c("ngIf",t.user.rol==="paciente"),s(7),m(t.user.nombre),s(5),m(t.user.apellido),s(5),m(t.user.edad),s(5),m(t.user.dni),s(5),m(t.user.email),s(5),m(t.user.rol),s(),k(43,(l=t.user.rol)==="paciente"?43:l==="especialista"?44:-1),s(2),c("ngIf",t.selectedSpecialty)}},dependencies:[D,V,q,$,U,A,j,L,B,W,G],styles:[".card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{background-color:#e4e4e4;border:none}.card-top[_ngcontent-%COMP%]{margin:150px 0}.h1-custom[_ngcontent-%COMP%]{font-weight:900;font-size:30px;color:#183058}.div-imgs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.img-perfil[_ngcontent-%COMP%]{width:200px;border-radius:50%}.perfil[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:10px;max-width:750px;margin:auto}.perfil-dato[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px;margin:0 30px;border-bottom:1px solid #ccc}.perfil-dato[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:700}.custom-select[_ngcontent-%COMP%]{width:150px}.div-horarios[_ngcontent-%COMP%]{width:750px;margin:auto;display:flex;flex-direction:column;align-items:center;padding-bottom:40px}.h-cambio-horario[_ngcontent-%COMP%]{font-weight:700;font-size:20px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:10px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px;width:90px;text-align:center;border:1px solid #ddd}.th-horas[_ngcontent-%COMP%]{background-color:#fff;font-weight:700}.th-horas-dias[_ngcontent-%COMP%]{padding:8px 0}.th-horas-datos[_ngcontent-%COMP%], .th-horas-datos[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#fff}input[type=number][_ngcontent-%COMP%]{width:60%;border:none;border-bottom:1px solid #000000;background-color:#fff;text-align:center}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]:focus{outline:none;box-shadow:none;border-color:transparent}td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:30px!important}.btn-reg[_ngcontent-%COMP%]{background-color:#183058;color:#fff;font-size:22px;font-weight:600}.errorMsg[_ngcontent-%COMP%]{color:red;font-size:15px;margin:0;font-weight:500}.msg-exito[_ngcontent-%COMP%]{color:#1b4fa8;font-size:15px;font-weight:700;margin:0}"]})}}return r})();export{de as PerfilComponent};
