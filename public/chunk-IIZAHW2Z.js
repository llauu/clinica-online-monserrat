import{a as w,b as ie,c as ne,d as re}from"./chunk-2VFJBFGA.js";import{a as W,b as X,c as ee,d as te}from"./chunk-QZWMSONR.js";import{a as J,b as Q}from"./chunk-KN6LMDCA.js";import{a as A,c as N}from"./chunk-52YDT6JR.js";import{$ as H,N as k,O as j,P as d,R as L,S as $,T as I,V as f,W as z,X as G,Y as Z,Z as K,_ as B,ba as Y}from"./chunk-CJRUVNUV.js";import{U as O,g as V}from"./chunk-4TCFWNX2.js";import{i as F,j as U}from"./chunk-FF7OLIXW.js";import{$a as n,Cb as r,Db as i,Eb as g,Ib as b,Lb as C,Mb as p,Vb as s,Wb as S,Xb as R,Zb as P,ab as h,e as y,oa as D,rb as c,tb as o,wa as v,xa as x}from"./chunk-52PAEBTB.js";function oe(e,l){e&1&&(r(0,"h1",9),s(1,"Registro"),i())}function ae(e,l){if(e&1&&(r(0,"h1",9),s(1),i()),e&2){let t=p();n(),R("Registro de ",t.regPaciente?"Paciente":"Especialista","")}}function le(e,l){if(e&1){let t=b();r(0,"div",14)(1,"button",15),C("click",function(){v(t);let m=p(2);return x(m.configurarFormulario("paciente"))}),g(2,"img",16),i(),r(3,"button",15),C("click",function(){v(t);let m=p(2);return x(m.configurarFormulario("especialista"))}),g(4,"img",17),i()()}}function se(e,l){e&1&&(r(0,"div",18),g(1,"mat-spinner"),i())}function de(e,l){if(e&1&&(r(0,"div",10)(1,"h2",11),s(2,"\xBFComo se desea registrar?"),i(),c(3,le,5,0,"div",12)(4,se,2,0,"div",13),i()),e&2){let t=p();n(3),o("ngIf",t.especialidadesCargadas===!0),n(),o("ngIf",t.isLoading)}}function ce(e,l){e&1&&(r(0,"p",47),s(1,"El nombre es requerido."),i())}function me(e,l){e&1&&(r(0,"p",47),s(1,"El nombre solo puede contener letras."),i())}function pe(e,l){if(e&1&&(r(0,"div",45),c(1,ce,2,0,"p",46)(2,me,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.nombre.getError("required")),n(),o("ngIf",t.form.controls.nombre.getError("pattern"))}}function _e(e,l){e&1&&(r(0,"p",47),s(1,"El apellido es requerido."),i())}function fe(e,l){e&1&&(r(0,"p",47),s(1,"El apellido solo puede contener letras."),i())}function ge(e,l){if(e&1&&(r(0,"div",45),c(1,_e,2,0,"p",46)(2,fe,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.apellido.getError("required")),n(),o("ngIf",t.form.controls.apellido.getError("pattern"))}}function ue(e,l){e&1&&(r(0,"p",47),s(1,"El edad es requerida."),i())}function ve(e,l){e&1&&(r(0,"p",47),s(1,"La edad no es valida."),i())}function xe(e,l){if(e&1&&(r(0,"div",45),c(1,ue,2,0,"p",46)(2,ve,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.edad.getError("required")),n(),o("ngIf",t.form.controls.edad.getError("pattern"))}}function Ce(e,l){e&1&&(r(0,"p",47),s(1,"El DNI es requerido."),i())}function he(e,l){e&1&&(r(0,"p",47),s(1,"El DNI no es valido."),i())}function be(e,l){e&1&&(r(0,"p",47),s(1,"El DNI ya esta registrado."),i())}function Ee(e,l){if(e&1&&(r(0,"div",45),c(1,Ce,2,0,"p",46)(2,he,2,0,"p",46)(3,be,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.dni.getError("required")),n(),o("ngIf",t.form.controls.dni.getError("pattern")),n(),o("ngIf",t.form.controls.dni.getError("dniExiste"))}}function ye(e,l){e&1&&(r(0,"p",47),s(1,"La obra social es requerida."),i())}function Se(e,l){if(e&1&&(r(0,"div",50),c(1,ye,2,0,"p",46),i()),e&2){let t=p(3);n(),o("ngIf",t.form.controls.obraSocial.getError("required"))}}function Re(e,l){if(e&1&&(r(0,"div",21)(1,"label",48),s(2,"Obra social"),i(),g(3,"input",49),c(4,Se,2,1,"div",34),i()),e&2){let t,a=p(2);n(3),o("formControl",a.form.controls.obraSocial),n(),o("ngIf",(t=a.form.get("obraSocial"))==null?null:t.touched)}}function Ie(e,l){if(e&1&&(r(0,"div")(1,"label"),g(2,"input",54),s(3),i()()),e&2){let t=l.$implicit,a=l.index;n(2),o("formControlName",a),n(),R(" ",t," ")}}function we(e,l){e&1&&(r(0,"p",47),s(1,"La especialidad es requerida."),i())}function Te(e,l){if(e&1&&(r(0,"div",50),c(1,we,2,0,"p",46),i()),e&2){let t=p(3);n(),o("ngIf",t.form.controls.especialidad.getError("required"))}}function qe(e,l){if(e&1&&(r(0,"div",21)(1,"label",51),s(2,"Especialidades"),i(),r(3,"div",52),c(4,Ie,4,2,"div",53),i(),c(5,Te,2,1,"div",34),i()),e&2){let t,a=p(2);n(4),o("ngForOf",a.especialidadesDisponibles),n(),o("ngIf",(t=a.form.get("especialidad"))==null?null:t.touched)}}function Me(e,l){if(e&1&&(r(0,"p",59),s(1),i()),e&2){let t=p(3);n(),S(t.errorMsjEspecialidad)}}function De(e,l){if(e&1){let t=b();r(0,"div",21)(1,"label",55),s(2,"Agregar especialidad"),i(),r(3,"div",56),g(4,"input",57),r(5,"button",58),C("click",function(){v(t);let m=p(2);return x(m.agregarEspecialidad())}),s(6,"Agregar"),i()(),c(7,Me,2,1,"p",42),i()}if(e&2){let t=p(2);n(7),o("ngIf",t.errorMsjEspecialidad!="")}}function Pe(e,l){e&1&&(r(0,"p",47),s(1,"El correo es requerido."),i())}function Fe(e,l){if(e&1&&(r(0,"div",50),c(1,Pe,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.mail.getError("required"))}}function Ue(e,l){e&1&&(r(0,"p",47),s(1,"La contrase\xF1a es requerida."),i())}function Ve(e,l){if(e&1&&(r(0,"div",50),c(1,Ue,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.pass.getError("required"))}}function Ae(e,l){e&1&&(r(0,"p",47),s(1,"La contrase\xF1a es requerida."),i())}function Oe(e,l){if(e&1&&(r(0,"div",50),c(1,Ae,2,0,"p",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.passRep.getError("required"))}}function Ne(e,l){e&1&&(r(0,"label",47),s(1,"La imagen es requerida."),i())}function ke(e,l){if(e&1&&(r(0,"div",50),c(1,Ne,2,0,"label",46),i()),e&2){let t=p(2);n(),o("ngIf",t.form.controls.imagenUno.getError("required"))}}function je(e,l){e&1&&(r(0,"p",47),s(1,"La imagen es requerida."),i())}function Le(e,l){if(e&1&&(r(0,"div",50),c(1,je,2,0,"p",46),i()),e&2){let t=p(3);n(),o("ngIf",t.form.controls.imagenDos.getError("required"))}}function $e(e,l){if(e&1){let t=b();r(0,"div",21)(1,"label",60),s(2,"Imagen dos"),i(),r(3,"input",61),C("change",function(m){v(t);let u=p(2);return x(u.onFileSelected(m,"imagenDos"))}),i(),c(4,Le,2,1,"div",34),i()}if(e&2){let t,a=p(2);n(3),o("formControl",a.form.controls.imagenDos),n(),o("ngIf",(t=a.form.get("imagenDos"))==null?null:t.touched)}}function ze(e,l){if(e&1&&(r(0,"p",59),s(1),i()),e&2){let t=p(2);n(),S(t.errorMsg)}}function Ge(e,l){e&1&&(r(0,"div",18),g(1,"mat-spinner"),i())}function Ze(e,l){if(e&1){let t=b();r(0,"div",19)(1,"form",20),C("ngSubmit",function(){v(t);let m=p();return x(m.register())}),r(2,"div",21)(3,"label",22),s(4,"Nombre"),i(),g(5,"input",23),c(6,pe,3,2,"div",24),i(),r(7,"div",21)(8,"label",25),s(9,"Apellido"),i(),g(10,"input",26),c(11,ge,3,2,"div",24),i(),r(12,"div",21)(13,"label",27),s(14,"Edad"),i(),g(15,"input",28),c(16,xe,3,2,"div",24),i(),r(17,"div",21)(18,"label",29),s(19,"DNI"),i(),g(20,"input",30),c(21,Ee,4,3,"div",24),i(),c(22,Re,5,2,"div",31)(23,qe,6,2,"div",31)(24,De,8,1,"div",31),r(25,"div",21)(26,"label",32),s(27,"Correo electronico"),i(),g(28,"input",33),c(29,Fe,2,1,"div",34),i(),r(30,"div",21)(31,"label",35),s(32,"Contrase\xF1a"),i(),g(33,"input",36),c(34,Ve,2,1,"div",34),i(),r(35,"div",21)(36,"label",37),s(37,"Repite contrase\xF1a"),i(),g(38,"input",38),c(39,Oe,2,1,"div",34),i(),r(40,"div",21)(41,"label",39),s(42,"Imagen uno"),i(),r(43,"input",40),C("change",function(m){v(t);let u=p();return x(u.onFileSelected(m,"imagenUno"))}),i(),c(44,ke,2,1,"div",34),i(),c(45,$e,5,2,"div",31),g(46,"ngx-recaptcha2",41,0),c(48,ze,2,1,"p",42),r(49,"button",43),C("click",function(){v(t);let m=p();return x(m.cancelarRegistro())}),s(50,"Cancelar"),i(),r(51,"button",44),s(52,"Registrarse"),i()(),c(53,Ge,2,0,"div",13),i()}if(e&2){let t,a,m,u,E,T,q,M,_=p();n(),o("formGroup",_.form),n(4),o("formControl",_.form.controls.nombre),n(),o("ngIf",(t=_.form.get("nombre"))==null?null:t.touched),n(4),o("formControl",_.form.controls.apellido),n(),o("ngIf",(a=_.form.get("apellido"))==null?null:a.touched),n(4),o("formControl",_.form.controls.edad),n(),o("ngIf",(m=_.form.get("edad"))==null?null:m.touched),n(4),o("formControl",_.form.controls.dni),n(),o("ngIf",(u=_.form.get("dni"))==null?null:u.touched),n(),o("ngIf",_.regPaciente),n(),o("ngIf",!_.regPaciente),n(),o("ngIf",!_.regPaciente),n(4),o("formControl",_.form.controls.email),n(),o("ngIf",(E=_.form.get("mail"))==null?null:E.touched),n(4),o("formControl",_.form.controls.pass),n(),o("ngIf",(T=_.form.get("pass"))==null?null:T.touched),n(4),o("formControl",_.form.controls.passRep),n(),o("ngIf",(q=_.form.get("passRep"))==null?null:q.touched),n(4),o("formControl",_.form.controls.imagenUno),n(),o("ngIf",(M=_.form.get("imagenUno"))==null?null:M.touched),n(),o("ngIf",_.regPaciente),n(),o("siteKey",_.siteKey)("useGlobalDomain",!1)("formControl",_.form.controls.recaptcha),n(2),o("ngIf",_.errorMsg!=""),n(3),o("disabled",_.form.invalid),n(2),o("ngIf",_.isLoading)}}var lt=(()=>{class e{constructor(t,a,m,u,E){this.authService=t,this.router=a,this.dniService=m,this.toastrSvc=u,this.firestoreService=E,this.errorMsg="",this.errorMsjEspecialidad="",this.regPaciente=null,this.especialidadesDisponibles=[],this.especialidadesCargadas=!1,this.siteKey="6LelmP4pAAAAAIRCS57ZV2nSRNip3kdHbSbwIRnt",this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.cargarEspecialidades()}cargarEspecialidades(){return y(this,null,function*(){this.especialidadesDisponibles=yield this.firestoreService.getEspecialidades(),this.especialidadesCargadas=!0,this.isLoading=!1})}configurarFormulario(t){t=="paciente"?(this.regPaciente=!0,this.form=new I({nombre:new f("",[d.pattern("^[a-zA-Z]+$"),d.required]),apellido:new f("",[d.pattern("^[a-zA-Z]+$"),d.required]),edad:new f("",[d.required,d.pattern("^[0-9]+$"),d.min(0),d.max(120)]),dni:new f("",{validators:[d.required,d.pattern("^[0-9]+$")],asyncValidators:w(this.dniService,"usuarios"),updateOn:"blur"}),obraSocial:new f("",[d.required]),email:new f("",[d.required]),pass:new f("",[d.required]),passRep:new f("",[d.required]),imagenUno:new f("",[d.required]),imagenDos:new f("",[d.required]),recaptcha:new f("",[d.required])})):(this.regPaciente=!1,this.form=new I({nombre:new f("",[d.pattern("^[a-zA-Z]+$"),d.required]),apellido:new f("",[d.pattern("^[a-zA-Z]+$"),d.required]),edad:new f("",[d.required,d.pattern("^[0-9]+$"),d.min(0),d.max(120)]),dni:new f("",{validators:[d.required,d.pattern("^[0-9]+$")],asyncValidators:w(this.dniService,"usuarios"),updateOn:"blur"}),especialidades:new H(this.especialidadesDisponibles.map(()=>new f(!1))),email:new f("",[d.required]),pass:new f("",[d.required]),passRep:new f("",[d.required]),imagenUno:new f("",[d.required]),recaptcha:new f("",[d.required])}))}onFileSelected(t,a){t.target.files.length>0&&(a==="imagenUno"?this.imagenUno=t.target.files[0]:this.imagenDos=t.target.files[0])}get especialidadesSeleccionadas(){return this.form.get("especialidades").controls.map((a,m)=>a.value?this.especialidadesDisponibles[m]:null).filter(a=>a!==null)}register(){this.form.valid&&(this.form.value.pass===this.form.value.passRep?(this.isLoading=!0,this.authService.createUser(this.form.value.email,this.form.value.pass).then(t=>{if(this.regPaciente===!1){let a={nombre:this.form.value.nombre,apellido:this.form.value.apellido,edad:this.form.value.edad,dni:this.form.value.dni,rol:"especialista",especialidad:this.especialidadesSeleccionadas,email:this.form.value.email,pass:this.form.value.pass,imagenUno:"",habilitado:!1};console.log("CREANDO USUARIO datos",a),this.addNewUser(a,t.user.uid)}else{let a={nombre:this.form.value.nombre,apellido:this.form.value.apellido,edad:this.form.value.edad,dni:this.form.value.dni,rol:"paciente",obraSocial:this.form.value.obraSocial,email:this.form.value.email,pass:this.form.value.pass,imagenUno:"",imagenDos:""};console.log("CREANDO USUARIO datos",a),this.addNewUser(a,t.user.uid)}}).catch(t=>{switch(console.log("HAY ERROR",t),t.code){case"auth/invalid-email":this.errorMsg="El correo electronico no es valido.";break;case"auth/missing-password":this.errorMsg="La contrase\xF1a no es valida.";break;case"auth/invalid-credential":this.errorMsg="El correo electronico o contrase\xF1a son incorrectos.";break}}).finally(()=>{this.isLoading=!1})):this.errorMsg="Las contrase\xF1as no coinciden.")}addNewUser(t,a){return y(this,null,function*(){t.rol=="paciente"?(t.imagenUno=yield this.saveImage(this.imagenUno,a+"/imagenUno"),t.imagenDos=yield this.saveImage(this.imagenDos,a+"/imagenDos")):t.rol=="especialista"&&(t.imagenUno=yield this.saveImage(this.imagenUno,a+"/imagenUno")),this.firestoreService.createDocument("usuarios",t,a),this.toastrSvc.success("Verifica tu correo electronico para poder iniciar sesion.","Usuario registrado"),this.router.navigate(["/home"])})}saveImage(t,a){return y(this,null,function*(){let m=ee(te(),a);return yield W(m,t),yield X(m)})}agregarEspecialidad(){let t=document.getElementById("nuevaEspecialidad");t.value!=""&&this.verificarEspecialidad(t.value)&&(this.errorMsjEspecialidad="",this.firestoreService.createDocument("especialidades",{nombre:t.value}),this.especialidadesDisponibles.push(t.value),this.form.patchValue({especialidad:t.value}))}verificarEspecialidad(t){return this.especialidadesDisponibles.find(m=>m===t)?(this.errorMsjEspecialidad="La especialidad ya existe.",!1):!0}cancelarRegistro(){this.errorMsg="",this.errorMsjEspecialidad="",this.regPaciente=null}static{this.\u0275fac=function(a){return new(a||e)(h(N),h(V),h(re),h(A),h(O))}}static{this.\u0275cmp=D({type:e,selectors:[["app-register"]],standalone:!0,features:[P],decls:9,vars:4,consts:[["captchaElem",""],[1,"container"],[1,"row","justify-content-center"],[1,"col-md-10","reg-container","card-top"],[1,"card","mt-5"],[1,"card-header"],["class","text-center mt-3 h1-custom",4,"ngIf"],["class","card-body d-flex flex-column justify-content-center align-items-center",4,"ngIf"],["class","card-body-form",4,"ngIf"],[1,"text-center","mt-3","h1-custom"],[1,"card-body","d-flex","flex-column","justify-content-center","align-items-center"],[1,"mb-4"],["class","container d-flex justify-content-center my-3",4,"ngIf"],["class","spinner-bg",4,"ngIf"],[1,"container","d-flex","justify-content-center","my-3"],[1,"btn-sel","mx-4",3,"click"],["src","assets/paciente.jpg","alt","Paciente",1,"img-btn-sel"],["src","assets/doctor.jpg","alt","Especialista",1,"img-btn-sel"],[1,"spinner-bg"],[1,"card-body-form"],[1,"d-flex","justify-content-center","row",3,"ngSubmit","formGroup"],[1,"col-6","my-3"],["for","nombre",1,"form-label"],["type","text","id","nombre",1,"form-control",3,"formControl"],["class","text-danger mt-1",4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido",1,"form-control",3,"formControl"],["for","edad",1,"form-label"],["type","text","id","edad",1,"form-control",3,"formControl"],["for","dni",1,"form-label"],["type","text","id","dni",1,"form-control",3,"formControl"],["class","col-6 my-3",4,"ngIf"],["for","mail",1,"form-label"],["type","text","id","mail",1,"form-control",3,"formControl"],["class","text-danger",4,"ngIf"],["for","pass",1,"form-label"],["type","password","id","pass",1,"form-control",3,"formControl"],["for","passRep",1,"form-label"],["type","password","id","passRep",1,"form-control",3,"formControl"],["for","foto1",1,"form-label"],["type","file","id","foto1",1,"form-control",3,"change","formControl"],[3,"siteKey","useGlobalDomain","formControl"],["class","errorMsg",4,"ngIf"],["type","button",1,"btn","btn-custom","mt-5","mb-4","me-3","col-5",3,"click"],["type","submit",1,"btn","btn-reg","mt-5","mb-4","ms-3","col-5",3,"disabled"],[1,"text-danger","mt-1"],["class","error-msg",4,"ngIf"],[1,"error-msg"],["for","obraSocial",1,"form-label"],["type","text","id","obraSocial",1,"form-control",3,"formControl"],[1,"text-danger"],["for","especialidades",1,"form-label"],["formArrayName","especialidades"],[4,"ngFor","ngForOf"],["type","checkbox",3,"formControlName"],["for","especialidad",1,"form-label"],[1,"row"],["type","text","id","nuevaEspecialidad",1,"form-control","w-50","ms-3"],["type","button",1,"btn","btn-custom","w-25","ms-3",3,"click"],[1,"errorMsg"],["for","foto2",1,"form-label"],["type","file","id","foto2",1,"form-control",3,"change","formControl"]],template:function(a,m){a&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),c(5,oe,2,0,"h1",6)(6,ae,2,1,"h1",6),i(),c(7,de,5,2,"div",7)(8,Ze,54,27,"div",8),i()()()()),a&2&&(n(5),o("ngIf",m.regPaciente===null),n(),o("ngIf",m.regPaciente!==null),n(),o("ngIf",m.regPaciente==null),n(),o("ngIf",m.regPaciente!=null))},dependencies:[Y,z,j,k,L,$,G,Z,B,K,U,ne,ie,F,Q,J],styles:[".error-msg[_ngcontent-%COMP%]{position:absolute;font-size:15px;margin:0}.errorMsg[_ngcontent-%COMP%]{color:red;font-size:15px;margin:0}.card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{background-color:#e4e4e4;border:none}.card-body-form[_ngcontent-%COMP%]{background-color:#e4e4e4;border:none;height:890px;padding:16px}.card-top[_ngcontent-%COMP%]{margin:150px 0}.btn-sel[_ngcontent-%COMP%]{transition:opacity .2s ease;background-color:#fff;border-radius:50%}.btn-sel[_ngcontent-%COMP%]:hover{opacity:.3}.img-btn-sel[_ngcontent-%COMP%]{border-radius:50%}.h1-custom[_ngcontent-%COMP%]{font-weight:900;font-size:30px;color:#183058}.btn-custom[_ngcontent-%COMP%]{background-color:#183058;color:#fff}.btn-reg[_ngcontent-%COMP%]{background-color:#fff}.spinner-bg[_ngcontent-%COMP%]{height:258px;display:flex;justify-content:center}"]})}}return e})();export{lt as RegisterComponent};
